<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="description" content="MCP Debug Host Dashboard - Monitor and manage development servers in real-time">
  <meta name="theme-color" content="#2563eb">
  <title>MCP Debug Host Dashboard</title>
  
  <!-- Preload critical resources -->
  <link rel="preload" href="style.css" as="style">
  <link rel="preload" href="app.js" as="script">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E🚀%3C/text%3E%3C/svg%3E">
  
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="additional-styles.css">
  <link rel="stylesheet" href="real-time-styles.css">
  <link rel="stylesheet" href="server-control-styles.css">
  <link rel="stylesheet" href="loading-enhancements.css">
  <link rel="stylesheet" href="accessibility-enhancements.css">
  <link rel="stylesheet" href="system-processes.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="header-content">
        <div class="header-left">
          <h1>🚀 MCP Debug Host Dashboard</h1>
          <p class="header-subtitle">Real-time development server monitoring</p>
        </div>
        <div class="header-right">
          <div class="connection-status" id="connectionStatus">
            <span class="status-dot"></span>
            <span class="status-text">Connecting...</span>
          </div>
          <button class="btn btn-secondary header-btn" id="refreshBtn" title="Refresh Sessions">
            🔄 Refresh
          </button>
          <button class="btn btn-secondary header-btn" id="settingsBtn" title="Settings">
            ⚙️
          </button>
        </div>
      </div>
    </header>
    
    <div class="main-content">
      <div class="sessions-section">
        <div class="section-header">
          <h2>Active Sessions</h2>
          <div class="session-count" id="sessionCount">0 sessions</div>
        </div>
        
        <!-- Session Filters -->
        <div class="session-filters" id="sessionFilters">
          <div class="filter-group">
            <span class="filter-label">Filter:</span>
            <select class="filter-select" id="statusFilter">
              <option value="all">All Status</option>
              <option value="running">Running</option>
              <option value="stopped">Stopped</option>
              <option value="starting">Starting</option>
              <option value="error">Error</option>
            </select>
          </div>
          <div class="filter-group">
            <select class="filter-select" id="frameworkFilter">
              <option value="all">All Frameworks</option>
              <option value="react">React/Vite</option>
              <option value="django">Django</option>
              <option value="laravel">Laravel</option>
              <option value="nodejs">Node.js</option>
            </select>
          </div>
          <div class="filter-group">
            <input type="text" class="filter-input" id="searchFilter" placeholder="Search sessions...">
          </div>
          <div class="filter-group">
            <button class="btn btn-secondary" id="favoritesFilter">⭐ Favorites</button>
            <button class="btn btn-secondary" id="clearFilters">🔄 Clear</button>
          </div>
        </div>
        
        <!-- Batch Operations -->
        <div class="batch-operations" id="batchOperations">
          <span class="batch-operations-label">Batch Actions:</span>
          <span class="batch-operations-count" id="batchCount">0 selected</span>
          <button class="btn btn-success" id="batchStart">▶️ Start All</button>
          <button class="btn btn-secondary" id="batchRestart">🔄 Restart All</button>
          <button class="btn btn-danger" id="batchStop">⏹️ Stop All</button>
          <button class="btn btn-secondary" id="batchClearSelection">❌ Clear Selection</button>
        </div>
        
        <div class="sessions-grid" id="sessionsGrid">
          <div class="no-sessions" id="noSessions">
            <div class="no-sessions-icon">📡</div>
            <h3>No Active Sessions</h3>
            <p>Start a development server with Claude Code and it will appear here automatically!</p>
            <div class="example-commands">
              <h4>Supported frameworks:</h4>
              <div class="framework-grid">
                <div class="framework-item">
                  <div class="framework-icon">⚛️</div>
                  <div class="framework-info">
                    <strong>React/Vite</strong>
                    <code>npm run dev</code>
                  </div>
                </div>
                <div class="framework-item">
                  <div class="framework-icon">🐍</div>
                  <div class="framework-info">
                    <strong>Django</strong>
                    <code>python manage.py runserver</code>
                  </div>
                </div>
                <div class="framework-item">
                  <div class="framework-icon">🎼</div>
                  <div class="framework-info">
                    <strong>Laravel</strong>
                    <code>php artisan serve</code>
                  </div>
                </div>
                <div class="framework-item">
                  <div class="framework-icon">🟢</div>
                  <div class="framework-info">
                    <strong>Node.js</strong>
                    <code>npm start</code>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- System Processes Section -->
        <div class="system-processes-section" id="systemProcesses" style="margin-top: 20px;">
          <div class="section-header">
            <h2>System Processes</h2>
            <div class="processes-controls">
              <select class="environment-select" id="environmentSelect">
                <option value="npm">npm</option>
                <option value="node">node</option>
                <option value="python">python</option>
                <option value="java">java</option>
                <option value="ruby">ruby</option>
                <option value="go">go</option>
                <option value="rust">rust</option>
                <option value="php">php</option>
              </select>
              <button class="btn btn-secondary" id="refreshProcesses">🔄 Refresh</button>
            </div>
          </div>
          
          <div class="processes-stats">
            <span id="totalProcesses">Total: 0</span>
            <span id="trackedProcesses">Tracked: 0</span>
            <span id="orphanedProcesses">Orphaned: 0</span>
          </div>
          
          <div class="processes-list" id="processesList">
            <table class="processes-table">
              <thead>
                <tr>
                  <th>PID</th>
                  <th>Status</th>
                  <th>Session</th>
                  <th>Port</th>
                  <th>CPU %</th>
                  <th>Memory %</th>
                  <th>Command</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="processesTableBody">
                <tr>
                  <td colspan="8" class="no-data">Select an environment and click Refresh to view processes</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <div class="log-viewer" id="logViewer">
        <div class="log-header">
          <div class="log-header-left">
            <h3>🔍 Advanced Log Viewer</h3>
            <div class="log-session-info" id="logSessionInfo"></div>
          </div>
          <div class="log-controls">
            <div class="log-control-group">
              <div class="log-search-container">
                <input type="text" 
                       id="logFilter" 
                       placeholder="Search logs (supports regex)..."
                       class="log-filter">
                <button id="regexToggle" class="btn btn-icon" title="Toggle Regex Mode">.*</button>
                <button id="clearFilter" class="btn btn-icon" title="Clear Filter">❌</button>
              </div>
              <div class="log-level-filters" id="logLevelFilters">
                <button class="btn btn-xs filter-btn active" data-level="all">All</button>
                <button class="btn btn-xs filter-btn" data-level="stdout">Output</button>
                <button class="btn btn-xs filter-btn" data-level="stderr">Errors</button>
                <button class="btn btn-xs filter-btn" data-level="warn">Warnings</button>
                <button class="btn btn-xs filter-btn" data-level="info">Info</button>
                <button class="btn btn-xs filter-btn" data-level="debug">Debug</button>
              </div>
            </div>
            <div class="log-control-group">
              <div class="log-export-menu">
                <button id="exportLogs" class="btn btn-secondary dropdown-trigger" title="Export Logs">
                  📥 Export ▼
                </button>
                <div class="dropdown-menu" id="exportMenu">
                  <a href="#" data-format="txt">📄 Export as Text</a>
                  <a href="#" data-format="json">📊 Export as JSON</a>
                  <a href="#" data-format="csv">📈 Export as CSV</a>
                  <a href="#" data-format="filtered">🔍 Export Filtered</a>
                </div>
              </div>
              <button id="bookmarkLog" class="btn btn-secondary" title="Bookmark Current Position">🔖 Bookmark</button>
              <button id="clearLogs" class="btn btn-secondary">🗑️ Clear</button>
              <button id="autoScroll" class="btn btn-secondary active">📜 Auto-scroll</button>
              <button id="pauseStream" class="btn btn-secondary">⏸️ Pause</button>
            </div>
          </div>
        </div>
        
        <div class="log-toolbar">
          <div class="log-toolbar-left">
            <button id="jumpToTop" class="btn btn-xs" title="Jump to Top">⬆️ Top</button>
            <button id="jumpToBottom" class="btn btn-xs" title="Jump to Bottom">⬇️ Bottom</button>
            <div class="bookmarks-container" id="bookmarksContainer"></div>
          </div>
          <div class="log-toolbar-right">
            <div class="log-analytics" id="logAnalytics">
              <span class="analytics-item" id="errorRate">Errors: 0</span>
              <span class="analytics-item" id="logRate">Rate: 0/s</span>
              <span class="analytics-item" id="totalLogs">Total: 0</span>
            </div>
          </div>
        </div>
        
        <div class="log-content-wrapper">
          <div class="log-content" id="logContent" tabindex="0">
            <div class="log-placeholder">
              <div class="log-placeholder-icon">📋</div>
              <h4>Select a session to view logs</h4>
              <p>Click on any session card above to start monitoring its console output with advanced filtering, search, and analytics</p>
            </div>
          </div>
          
          <div class="log-sidebar" id="logSidebar">
            <div class="sidebar-header">
              <h4>📊 Log Analytics</h4>
              <button id="toggleSidebar" class="btn btn-icon">📈</button>
            </div>
            <div class="sidebar-content">
              <div class="analytics-section">
                <h5>Performance Metrics</h5>
                <div class="metric-item">
                  <span>Messages/sec:</span>
                  <span id="messageRate">0</span>
                </div>
                <div class="metric-item">
                  <span>Error Rate:</span>
                  <span id="errorRatePercent">0%</span>
                </div>
                <div class="metric-item">
                  <span>Buffer Size:</span>
                  <span id="bufferSize">0 KB</span>
                </div>
              </div>
              
              <div class="analytics-section">
                <h5>🎯 Pattern Detection</h5>
                <div class="pattern-list" id="patternList">
                  <div class="pattern-item">No patterns detected</div>
                </div>
              </div>
              
              <div class="analytics-section">
                <h5>📈 Log Distribution</h5>
                <canvas id="logChart" width="200" height="120"></canvas>
              </div>
            </div>
          </div>
          
          <div class="log-stats" id="logStats">
            <span class="log-count">0 logs</span>
            <span class="log-filter-count" id="logFilterCount"></span>
            <span class="log-position" id="logPosition"></span>
          </div>
        </div>
        
        <!-- Search Results Panel -->
        <div class="search-results-panel" id="searchResultsPanel">
          <div class="search-results-header">
            <h4>🔍 Search Results</h4>
            <div class="search-navigation">
              <button id="prevResult" class="btn btn-xs">⬆️</button>
              <span id="searchResultsInfo">0 of 0</span>
              <button id="nextResult" class="btn btn-xs">⬇️</button>
            </div>
            <button id="closeSearchResults" class="btn btn-icon">✖️</button>
          </div>
          <div class="search-results-list" id="searchResultsList"></div>
        </div>
      </div>
    </div>
  </div>
  
  <script src="../websocket-manager.js"></script>
  <script src="loading-enhancements.js"></script>
  <script src="real-time-manager.js"></script>
  <script src="app.js"></script>
  <script src="dashboard-fixes.js"></script>
  <script src="api-config.js"></script>
  <script src="session-controls.js"></script>
  <script src="server-control-features.js"></script>
  <script src="real-time-enhancements.js"></script>
  <script src="theme-enhancement.js"></script>
  <script src="system-processes.js"></script>
</body>
</html>